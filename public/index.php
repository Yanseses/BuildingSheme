<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
    <title>Страница создания формы</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css"> 
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/slider.css">
</head>
<body>
    <h1 class="interectiv-card">
        Интерактивная карта здания
    </h1>
    <div class="first-pade-container">
        <svg class="plane" viewBox="0 0 660 467">
            <a href="#" class="js-first-page">
                <path class="border-plane" d="m 623.12559,354.10495 0.41303,21.4776 L 408.90036,457.36262 1.1014151,388.79953 0.96373821,364.84375 408.21197,382.32871 Z" fill="#006400" description-data="Первый этаж"></path>
            </a>

            <a href="#" class="js-first-page">
                <path class="border-plane" d="M 6.3331368,365.83111 406.8352,381.11324 622.57488,353.02716 622.16185,326.04249 407.66126,316.54278 6.1954599,339.25947 Z" fill="#006400" description-data="Второй этаж"></path>
            </a>

            <a href="#" class="js-first-page">
                <path class="border-plane" d="m 7.296875,310.53022 399.951355,-75.3781 215.31948,57.13684 0.1947,27.45334 -215.51418,-11.34607 -400.0890319,25.6079 z" fill="#006400" description-data="Третий этаж"></path>
            </a>

            <a href="#" class="js-first-page">
                <path class="border-plane" d="M 7.5934763,303.59423 7.7395047,284.17245 405.80262,172.30262 620.47463,266.52736 620.645,285.99781 406.69752,220.0765 Z" fill="#006400" description-data="Четвертый этаж"></path>
            </a>
            
            <a href="#" class="js-first-page">
                <path class="border-plane" d="M 55.483785,260.61155 55.690301,232.93849 410.55248,86.140514 635.39387,234.0117 635.51556,258.90954 411.20644,145.72019 Z" fill="#006400" description-data="Пятый этаж"></path>
            </a>
        </svg>
            
        <div class="description-floor">
            
        </div>
        <img class="first-page-img" src="img/big-sheme.jpg" alt="Основной план">
    </div>

    <div class="five_floor-container">
        <svg class="five_floor-plane" viewBox="0 0 3508 2480">
            <a href="#" class="js_show-room-data" data-room-number="514">
                <path class="little-border" d="m 888.75054,1430.631 v 188.2308 H 1066.746 V 1430.631 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="516">
                <path class="little-border" d="m 769.75176,1130.7657 v 163.0949 h 65.993 v -163.0949 z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="521">
                <path class="little-border" d="m 185.46922,1288.7227 h 583.65294 v -160.1885 h 74.04903 v 164.7956 h 136.1745 v -60.0053 h 134.71761 v -18.0738 h 57.5283 v 20.2426 h 27.6717 v -19.5199 h 51.7025 v 19.5199 h 60.4409 v -156.1589 h 519.9372 v 193.03 h 171.1282 v 408.4711 h 192.9741 v -234.2384 h 418.4171 V 1247.061 h 231.1408 V 115.63031 H 179.04925 V 1289.7141 Z" fill="#DEDA02"></path>
            </a>
            
            <a href="#" class="js_show-room-data" data-room-number="532">
                <path class="little-border" d="m 2005.7483,1685.7875 v 702.0766 h 840 v -1141 h -226 v 201.8938 H 2383.719 v 237.0808 z" fill="#006400"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="501">
                <path class="little-border" d="m 1834.7483,2387.8628 v -435.0543 h 58.9803 V 1553.437 h -47.8029 v 18.4001 h -165.3272 v 184.6897 h 10.6014 v 631.5333 z" fill="#DEDA02"></path>
            </a>
            
            <a href="#" class="js_show-room-data" data-room-number="511">
                <path class="little-border" d="m 1160.6079,1433.3327 v 953.8351 h 526.015 v -622.545 h -10.5074 v -189.677 h -11.6984 v -197.5785 h -364.8455 v 54.151 z" fill="#006400"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="515">
                <path class="little-border" d="m 179.06787,1613.2928 v 773.0745 h 984.95973 v -821.8899 h -99.0661 v 57.1408 H 885.47497 V 1430.7837 H 634.48543 v 187.921 z" fill="#DEDA02"></path>
            </a>
        </svg>

        <img class="five_floor-img" src="img/5-этаж.svg" alt="Пятый этаж">
        <a class="back-button js-back-button" id="500">К главному плану</a>
    </div>

    <div class="for_floor-container">
        <svg class="for_floor-plane" viewBox="0 0 3508 2480">
            <a href="#" class="js_show-room-data" data-room-number="400a">
                <path class="little-border" d="m 237.37961,1288.4344 h 415.81862 v -249.951 H 583.95008 V 819.04892 H 491.75201 V 764.58035 H 237.22195 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="400b">
                <path class="little-border" d="M 656.11805,1286.2024 H 741.6494 V 173.99327 H 239.99831 v 595.05692 h 254.14 v 54.87576 h 92.97435 V 1039.218 h 69.63613 z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="401">
                <path class="little-border" d="M 740.46439,171.1859 V 1288.856 h 276.67321 v -35.8517 h 46.3157 v -190.8191 h 254.8009 v 23.5114 h 366.9133 V 170.70041 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="402">
                <path class="little-border" d="m 1687.3572,1085.0481 h 170.5383 v 202.067 h 177.8551 v -10.9981 h 821.939 V 171.52477 H 1687.3572 Z" fill="#006400"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="403">
                <path class="little-border" d="m 2013.5665,1282.6861 v 1068.753 h 844.5271 V 1273.5924 h -818.8741 v 9.1219 z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="404">
                <path class="little-border" d="m 1234.7157,1417.8821 h 87.6197 v -19.6934 h 580.8344 v 539.2312 h -68.8624 v 414.2049 h -600.9867 z" fill="#DEDA02"></path>
            </a> 

            <a href="#" class="js_show-room-data" data-room-number="405">
                <path class="little-border" d="M 240.31585,1605.8915 H 650.41613 V 1410.6591 H 1232.739 v 940.524 H 240.15039 Z" fill="#DEDA02"></path>
            </a> 
        </svg>
            
        <img class="for_floor-img" src="img/4-этаж.svg" alt="Четвертый этаж">
        <a class="back-button js-back-button" id="400">К главному плану</a>
    </div>

    <div class="three_floor-container">
        <svg class="three_floor-plane" viewBox="0 0 3508 2480">
            <a href="#" class="js_show-room-data" data-room-number="303">
                <path class="little-border" d="M 1929.6408,2334.8382 V 1270.4633 h 33.5944 v -13.2211 h 810.2908 v 1077.6732 z" fill="#006400"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="302">
                <path class="little-border" d="m 1520.7642,156.07465 v 912.46325 h 255.4241 v 202.3694 h 172.4987 v -11.7062 h 825.0578 V 156.17152 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="300">
                <path class="little-border" d="M 156.44833,1272.2266 H 552.14701 V 712.68641 H 156.40344 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="301">
                <path class="little-border" d="M 156.08316,155.90029 V 711.5213 h 397.65258 v 560.7661 h 172.67037 255.03643 v -227.1695 h 260.26726 v 24.272 h 279.74 V 155.97778 Z" fill="#006400"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="306">
                <path class="little-border" d="M 156.88989,2334.9205 H 1066.0897 V 1382.465 H 566.80213 v 207.7294 H 156.64571 Z" fill="#DEDA02"></path>
            </a>

            <a href="#" class="js_show-room-data" data-room-number="305">
                <path class="little-border" d="m 1066.1831,1382.3167 v 952.8871 h 685.9659 v -415.3715 h 70.35 v -549.5889 h -583.7667 v 12.0652 z" fill="#DEDA02"></path>
            </a>
        </svg>
            
        <img class="three_floor-img" src="img/3-этаж.svg" alt="Третий этаж">
        <a class="back-button js-back-button" id="300">К главному плану</a>
    </div>

    <div class="two_floor-container">
        <svg class="two_floor-plane" viewBox="0 0 3508 2480">
            <a href="#" class="js_show-room-data" data-room-number="201">
                <path class="little-border" d="M 180.3287,160.68802 V 2341.6642 H 2798.1194 V 160.68802 Z" fill="#DEDA02"></path>
            </a>
        </svg>
            
        <img class="two_floor-img" src="img/2-этаж.svg" alt="Второй этаж">
        <a class="back-button js-back-button" id="200">К главному плану</a>
    </div>

    <div class="first_floor-container">
        <svg class="first_floor-plane" viewBox="0 0 3508 2480">
             <a href="#" class="js_show-room-data" data-room-number="101">
                <path class="little-border" d="M 151.73827,141.92149 V 2321.2707 H 2769.7178 V 141.92149 Z" fill="#DEDA02"></path>
            </a>
        </svg>
            
        <img class="first_floor-img" src="img/1-этаж.svg" alt="Первый этаж">
        <a class="back-button js-back-button" id="100">К главному плану</a>
    </div>

    <div class="popup-rent-form js-popup-rent js_room-data-popup">
        <section class="window-rent-form">
            <header class="header-rent-form">
                <h2 class="title-form">
                    Офис №<span class="populate-data" data-field="room_number"></span>
                </h2>
                <button class="button-back js-button-back">
                    Х
                </button>
            </header>
            <article class="body-rent-form">
                <div class="left-section">
                    <div class="block-slider">
                        <div class="viewport">
                            <ul id="room-photos-slides" class="slider-wraper">
                                <li class="slide">
                                    <img src="http://placehold.it/450x290.jpeg&text=Your+first+Image" alt="placehold1" class="img">
                                </li>
                                <li class="slide">
                                    <img src="http://placehold.it/450x290.jpeg&text=Your+second+Image" alt="placehold2" class="img">
                                </li>
                                <li class="slide">
                                    <img src="http://placehold.it/450x290.jpeg&text=Your+third+Image" alt="placehold3"class="img">
                                </li>
                                <li class="slide">
                                    <img src="http://placehold.it/450x290.jpeg&text=Your+last+Image" alt="placehold4" class="img">
                                </li>
                            </ul>
                        </div>

                        <div class="viewport-outside">
                            <ul id="room-photos-buttons" class="slider-menu">
                                <li class="btn-slider">
                                    <img src="img/page1.jpg" alt="1" class="mini-img">
                                </li>
                                <li class="btn-slider">
                                    <img src="img/page2.jpg" alt="2" class="mini-img">
                                </li>
                                <li class="btn-slider">
                                    <img src="img/page1.jpg" alt="1" class="mini-img">
                                </li>
                                <li class="btn-slider">
                                    <img src="img/page2.jpg" alt="1" class="mini-img">
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="right-section">
                    <h3 class="specifications-title">
                        Характеристики
                    </h3>
                    <ul class="properties-rooms">
                        <li class="properties-rooms-list">
                            Размер помещения: <span class="populate-data" data-field="room_size" style="font-weight: 600"></span> м<sup>2</sup>
                        </li>
                        <li class="properties-rooms-list">
                            Стоимость аренды в год (за м<sup>2</sup>): <span class="populate-data" data-field="room_price_rent" style="font-weight: 600"></span> руб.
                        </li>
                        <li class="properties-rooms-list">
                            Общая стоимость аренды в месяц: <span class="populate-data" data-field="room_price_rent_mounth" style="font-weight: 600"></span> руб.
                        </li>
						<li class="properties-rooms-list">
                            Стоимость продажи: <span class="populate-data" data-field="room_price_sale" style="font-weight: 600"></span> руб.
                        </li>
                    </ul>

                    <h3 class="description-title">
                        Описание
                    </h3>

                    <p class="description-room populate-data" data-field="room_description">
                        Тестовое описание Тестовое описание Тестовое описание Тестовое описание Тестовое описание Тестовое описание 
                    </p>
                </div>
            </article>
            <footer class="footer-rent-form">
                <button class="js-callback-btn rent-bnt-callback">
                    Оставить заявку
                </button>
                <button data-href="https://google.com" class="rent-bnt-callback js-button-link js-presentation-button">
                    Презентация
                </button>
            </footer>
        </section>
    </div>
    <div class="js-loader loader-window">
        <div class="loader-text">
            ЗАГРУЗКА...
        </div>
    </div>
    <div class="js-room_taken room_taken">
        <div class="room_taken-container">
            <h3 class="room_taken-heading">
                На данный момент этот офис занят
            </h3>
            <p class="room_taken-description">
                Вы можете посмотреть другие наши предложения, или связаться с нами по форме ниже.
            </p>
            <button class="js-room_taken_btn room_taken-button">
                Свяжитесь с нами
            </button>
        </div>
    </div>
	
	<div class="js-callback room_taken">
        <div class="callBack-container">
			<h3 class="callBack-heading">
			    Форма обратной связи
			</h3>
			
			<form class="js-callBack-form">
                <fieldset style="border: none">
                    <label>Ваше имя *<br>
                        <input style="border: none; border-bottom-width: 1px; border-bottom-style: solid; width: 100%; padding: 5px; margin-top: 10px" required type="text">
                    </label>
                </fieldset>
                <fieldset style="border: none">
                    <label>Ваш номер телефона<br>
                        <input style="border: none; border-bottom-width: 1px; border-bottom-style: solid; width: 100%; padding: 5px; margin-top: 10px" type="phone">
                    </label>
                </fieldset>
                <fieldset style="border: none">
                    <label>Почта для связи *<br>
                        <input style="border: none; border-bottom-width: 1px; border-bottom-style: solid; width: 100%; padding: 5px; margin-top: 10px" required type="email">
                    </label>
                </fieldset>
                <button type="submit" style="margin: 15px; padding: 10px">
                    Отправить
                </button>
            </form>
        </div>
    </div>

<footer>
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/script.js"></script>
    <script src="js/slider.js"></script>
    <script>
    (() => {
        var $ = jQuery;
        var room_taken = $('.js-room_taken');
        var callbackWindow = $('.js-callback');
        var callbackForm = $('.js-callBack-form');
        
        callbackForm.on('submit', function (e){
            e.preventDefault();

        });

        $(document).on('click','.js-button-link', function(){
            window.open($(this).attr('data-href'));
        });
        
        room_taken.on('click', '.js-room_taken_btn', function(){
            room_taken.hide();
            callbackWindow.show();

            callbackWindow.click(function(event){
                if (event.target == this) {
                    $(this).hide();
                }
            });
        });

        $('.js_show-room-data').on('click', function(e){
            e.preventDefault();
            
            var room_number = $(this).attr('data-room-number');
            var floor = $(this).closest('div');
            var modal = $('.js_room-data-popup');

            $.ajax({
                url: '/wp-admin/admin-ajax.php',
                type: 'POST',
                data: {
                    action: 'load_cabinet_data',
                    room_number: room_number
                },
                beforeSend: function( xhr ) {
                    $('.js-loader').show();	
                },
                success: function( data ) {
                    
                    data = JSON.parse(data);

                    if(!data || data.error){
                        alert('ERROR #' + data.error + ': ERROR LOADING ROOM')
                    } else {

                        if (data.data.room_status == 'vacant') {
                    
                            modal.find('.populate-data').each((i,el) => {
                                $(el).text(
                                    data.data[$(el).attr('data-field')]
                                );
                            });
							
							$('.js-callback-btn').on('click', function(){
								callbackWindow.show();
								
								callbackWindow.click(function(event){
                            		if (event.target == this) {
                                		$(this).hide();
                            		}
                        		});
							});
    
                            $('.js-presentation-button').attr('data-href', data.data.presentation_link);
    
                            var slides  = $('#room-photos-slides');
                            var buttons = $('#room-photos-buttons');
    
                            var photos = data.data.photos.split("\n");
							
                            slides.html('');
                            buttons.html('');
							
                            for(var i = 0; i < photos.length; i++){
    
                                var src = photos[i].trim();
    
                                if(!src) continue;
    
                                var slide = $('<li class="slide">');
                                var s_img = $('<img class="img">');
								
                                slide.append(s_img);
                                s_img.attr('src', src);
    
                                var button = $('<li class="btn-slider">');
                                var b_img = $('<img class="mini-img">');
								
                                button.append(b_img);
                                b_img.attr('src', src);
    
                                slides.append(slide);
                                buttons.append(button);
								
								if(photos.length > 1) {
                                    var slideLength = data.data.photos.split("\n").length;
                                    
                                    slide.css('width', 'calc(100% /' + slideLength + ')');
                                    slides.css('width', 'calc(100% *' + slideLength + ')');
                                }
                                
                            } 

                        
                            floor.hide();
                            modal.show();
                        
                        } else {
                                
                            room_taken.show();
                                
                        }
                        
                        room_taken.click(function(event){
                            if (event.target == this) {
                                $(this).hide();
                            }
                        });
                        
                    }

                    $('.js-loader').hide();
                }
            });

        })
    })();
    </script>
</footer>
</body>
</html>